<!-- AUTO-GENERATED by Opentix -- do not edit manually. -->
<!-- This file is regenerated from config.yml each time the extension activates. -->

# Opentix -- AI Agent Context

This file describes the ticket management system stored in this directory.
Use it as a reference when reading, creating, or modifying tickets and sprints.

---

## What is Opentix?

Opentix is a git-native ticket management system. All project tickets are stored
as Markdown files with YAML frontmatter inside this `.opentix/` directory.
The data lives on the repository's default branch and is synced through Git,
keeping developer working branches untouched.

---

## Directory Structure

```
.opentix/
├── AGENTS.md          # This file (auto-generated context for AI agents)
├── config.yml         # Project configuration (prefix, statuses, sync settings)
├── index.json         # Ticket index cache (id, title, status, priority, sprint)
├── sprints.json       # Sprint definitions (date ranges, types)
├── team.yml           # Team members (auto-populated from git config)
├── tickets/           # One Markdown file per ticket
│   ├── OPTX-0001.md
│   ├── OPTX-0002.md
│   └── ...
└── templates/
    └── default.md     # Default ticket template
```

---

## Ticket Format

Each ticket is a Markdown file in `tickets/` named `<ID>.md`.

### Example Ticket (`tickets/OPTX-0001.md`)

```markdown
---
id: "OPTX-0001"
title: "Implement user authentication"
status: backlog
sprint: "SPR-0001"
priority: high
assignees:
  - alice
  - bob
labels:
  - auth
  - backend
createdAt: "2025-06-01T10:00:00.000Z"
updatedAt: "2025-06-02T14:30:00.000Z"
createdBy: "alice"
branch: "feat/auth"
linkedCommits:
  - "abc1234"
---

## Description

Implement JWT-based authentication with refresh tokens.
Users should be able to sign in with email and password.

## Acceptance Criteria

- [ ] Login endpoint returns JWT + refresh token
- [ ] Middleware validates JWT on protected routes
- [ ] Refresh token rotation works correctly

## Comments

### 2025-06-01T10:00:00.000Z | alice

Ticket created.

### 2025-06-02T14:30:00.000Z | bob

Started working on the middleware. Will handle token expiry edge cases.
```

---

## Frontmatter Field Reference

| Field | Type | Required | Description |
|---|---|---|---|
| `id` | string | Yes | Unique ticket ID (`OPTX-NNNN`). Immutable after creation. |
| `title` | string | Yes | Short summary of the ticket. |
| `status` | string | Yes | Current status. One of: `backlog`, `in-progress`, `review`, `done`, `cancelled`. |
| `sprint` | string | No | Sprint ID (e.g., `SPR-0001`). Only sprints with type `sprint` (not `break`) can be assigned. |
| `priority` | string | Yes | One of: `low`, `medium`, `high`, `critical`. |
| `assignees` | string[] | Yes | List of assignee names (can be empty `[]`). |
| `labels` | string[] | Yes | List of labels for categorization (can be empty `[]`). |
| `createdAt` | string | Yes | ISO 8601 timestamp of creation. |
| `updatedAt` | string | Yes | ISO 8601 timestamp of last update. |
| `createdBy` | string | Yes | Git username of the creator. |
| `branch` | string | No | Git branch linked to this ticket. |
| `linkedCommits` | string[] | No | List of commit SHAs related to this ticket. |

---

## Markdown Sections

Every ticket has three sections in this order:

1. **## Description** -- Detailed explanation of the work.
2. **## Acceptance Criteria** -- Checklist items (Markdown checkboxes).
3. **## Comments** -- Append-only log of updates.

### Comment Format

Each comment is an H3 heading with timestamp and author, followed by the body:

```markdown
### <ISO-timestamp> | <author>

Comment body text here.
```

---

## ID Format

- **Tickets**: `OPTX-NNNN` (zero-padded 4-digit number, e.g., `OPTX-0001`, `OPTX-0042`)
- **Sprints**: `SPR-NNNN` (e.g., `SPR-0001`, `SPR-0012`)
- IDs are auto-generated and immutable. Never change an existing ID.

---

## Status Workflow

```
backlog -> in-progress -> review -> done -> cancelled
```

Valid statuses for this project: `backlog`, `in-progress`, `review`, `done`, `cancelled`

When moving a ticket to a new status, update only the `status` field and the
`updatedAt` timestamp. Do not change other fields unless intentional.

---

## Sprint Format

Sprints are defined in `sprints.json`:

```json
{
  "version": 1,
  "nextId": 3,
  "sprints": [
    {
      "id": "SPR-0001",
      "name": "Sprint 1",
      "startDate": "2025-06-01",
      "endDate": "2025-06-14",
      "type": "sprint"
    },
    {
      "id": "SPR-0002",
      "name": "Summer Break",
      "startDate": "2025-06-15",
      "endDate": "2025-06-22",
      "type": "break"
    }
  ]
}
```

| Field | Type | Description |
|---|---|---|
| `id` | string | Immutable, auto-generated (`SPR-NNNN`). |
| `name` | string | Display label, freely editable. |
| `startDate` | string | Calendar date `YYYY-MM-DD`. |
| `endDate` | string | Calendar date `YYYY-MM-DD`. |
| `type` | string | `sprint` or `break`. Only `sprint` can be assigned to tickets. |

**Rules**:
- No overlapping date ranges between sprints.
- `startDate` must be on or before `endDate`.
- Sprints are stored sorted by `startDate`.
- A sprint cannot be deleted if any tickets reference it.

---

## Team Members (`team.yml`)

Team members are auto-registered when they open the project with Opentix.
Each developer's `git config user.name` and `git config user.email` are read
on extension activation and added to `team.yml` if not already present
(deduplicated by email). The file grows organically as developers open the project.

```yaml
members:
  - name: Alice Johnson
    email: alice@example.com
  - name: Bob Smith
    email: bob@example.com
```

| Field | Type | Description |
|---|---|---|
| `name` | string | Developer's display name (from `git config user.name`). |
| `email` | string | Developer's email (from `git config user.email`). Used for deduplication. |

**Rules**:
- Members are sorted alphabetically by name.
- Deduplication is by email (case-insensitive).
- If a developer changes their `user.name`, the existing entry is updated.
- Do not manually remove members -- the list is append-only via auto-registration.

---

## Configuration (`config.yml`)

```yaml
prefix: OPTX
statuses:
  - backlog
  - in-progress
  - review
  - done
  - cancelled
defaultAssignee: null
autoSync: true
syncIntervalSeconds: 60
pushMode: direct
commitStrategy: immediate
commitDebounceSeconds: 5
```

| Field | Description |
|---|---|
| `prefix` | Ticket ID prefix (e.g., `OPTX`). |
| `statuses` | Ordered list of valid ticket statuses. |
| `defaultAssignee` | Auto-assigned user for new tickets (`null` for none). |
| `autoSync` | Enable background sync with remote. |
| `syncIntervalSeconds` | Interval between automatic syncs. |
| `pushMode` | `direct` (push to default branch) or `branch-pr` (open PR). |
| `commitStrategy` | `immediate` (commit per action) or `debounce` (batch). |
| `commitDebounceSeconds` | Seconds to wait before batching commits. |

---

## Index File (`index.json`)

The index is a lightweight cache of all tickets for fast lookups:

```json
{
  "version": 1,
  "lastUpdated": "2025-06-02T14:30:00.000Z",
  "nextId": 5,
  "tickets": [
    {
      "id": "OPTX-0001",
      "title": "Implement user authentication",
      "status": "backlog",
      "priority": "high",
      "sprint": "SPR-0001",
      "assignees": ["alice", "bob"],
      "updatedAt": "2025-06-02T14:30:00.000Z"
    }
  ]
}
```

> **Note**: The index is auto-rebuilt from ticket files. Do not rely on it as the
> source of truth -- always read the actual ticket Markdown files for full data.

---

## Rules for AI Agents

### Reading Tickets

- Read ticket files from `.opentix/tickets/<ID>.md`.
- Use `index.json` for quick lookups (list of IDs, statuses, priorities).
- For full ticket details (description, comments), read the Markdown file directly.
- Sprint details are in `sprints.json`.

### Creating Tickets

- **Do not** create ticket files manually. Use the Opentix extension commands.
- If you must create a ticket file, follow the exact format above:
  - Generate the next ID from `index.json` `nextId` field.
  - Include all required frontmatter fields.
  - Set `createdAt` and `updatedAt` to the current ISO 8601 timestamp.
  - Set `createdBy` to the git username.
  - Add an initial comment: `Ticket created.`
  - Update `index.json` to include the new ticket and increment `nextId`.

### Modifying Tickets

- Only update the fields you intend to change.
- **Always** update the `updatedAt` timestamp when modifying a ticket.
- **Never** change the `id` or `createdAt` fields.
- Append new comments at the end of the Comments section (never edit existing comments).
- Keep the section order: Description, Acceptance Criteria, Comments.

### Referencing Tickets

- Reference tickets by their ID (e.g., `OPTX-0001`) in commit messages, comments, and documentation.
- When making code changes related to a ticket, mention the ticket ID in the commit message.
- Commit message convention: `opentix: <action> <ID> - <description>`

### Things to Avoid

- **Do not** edit `AGENTS.md` (this file) -- it is auto-generated.
- **Do not** manually edit `index.json` unless you are also updating the corresponding ticket files.
- **Do not** delete a sprint from `sprints.json` if any tickets reference it.
- **Do not** assign a `break`-type sprint to a ticket -- only `sprint`-type entries are valid.
- **Do not** use statuses not listed in `config.yml`.

---

## Current Ticket Context

Opentix automatically detects the current ticket from your git branch name
(pattern: `OPTX-NNNN` in the branch name) and writes the full ticket
context to `CURRENT_TICKET.md` at the repository root.

**Read `CURRENT_TICKET.md` first** before starting any coding task to
understand the requirements, acceptance criteria, and current status of
the ticket you are working on.

If the file is missing or says "No ticket detected", check the branch name
or read tickets directly from `.opentix/tickets/`.

This feature can be disabled in `config.yml` (`aiContext.enabled: false`)
or per-developer via VS Code setting `opentix.aiContext.enabled`.

---

## Quick Reference

| What | Where |
|---|---|
| Current ticket context | `CURRENT_TICKET.md` (repo root, auto-generated) |
| All tickets | `.opentix/tickets/*.md` |
| Ticket by ID | `.opentix/tickets/OPTX-NNNN.md` |
| Ticket index (fast lookup) | `.opentix/index.json` |
| Sprint definitions | `.opentix/sprints.json` |
| Team members | `.opentix/team.yml` |
| Project configuration | `.opentix/config.yml` |
| Ticket template | `.opentix/templates/default.md` |
| Valid statuses | `backlog`, `in-progress`, `review`, `done`, `cancelled` |
| ID pattern | `OPTX-NNNN` (zero-padded) |
| Sprint ID pattern | `SPR-NNNN` (zero-padded) |
| Priority levels | `low`, `medium`, `high`, `critical` |
| Commit prefix | `opentix: <message>` |
